const XLSX = require('xlsx');
const path = require('path');

// ุฅูุดุงุก ุจูุงูุงุช ูููุฐุฌ ุงูุฃุญุฏุงุซ
const eventsData = [
  {
    'ุงูุนููุงู': 'ุนูุฏ ุงูุฃุถุญู',
    'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2025-06-15',
    'ุชุงุฑูุฎ ุงูุงูุชูุงุก': '',
    'ููุช ุงูุจุฏุงูุฉ': '',
    'ููุช ุงูููุงูุฉ': '',
    'ููู ูุงูู': 'ูุนู',
    'ุงููุตู': 'ุนุทูุฉ ุฑุณููุฉ',
    'ุงูููุน': 'ุนุทูุฉ',
    'ุงูููู': '#ff6b6b'
  },
  {
    'ุงูุนููุงู': 'ุนุทูุฉ ููุชุตู ุงูุณูุฉ ุงูุฏุฑุงุณูุฉ',
    'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2025-01-20',
    'ุชุงุฑูุฎ ุงูุงูุชูุงุก': '2025-01-26',
    'ููุช ุงูุจุฏุงูุฉ': '',
    'ููุช ุงูููุงูุฉ': '',
    'ููู ูุงูู': 'ูุนู',
    'ุงููุตู': 'ุนุทูุฉ ุฃุณุจูุนูุฉ ูู ููุชุตู ุงูุณูุฉ ุงูุฏุฑุงุณูุฉ',
    'ุงูููุน': 'ุนุทูุฉ',
    'ุงูููู': '#ff6b6b'
  },
  {
    'ุงูุนููุงู': 'ุงุฌุชูุงุน ุฃูููุงุก ุงูุฃููุฑ',
    'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2025-06-20',
    'ุชุงุฑูุฎ ุงูุงูุชูุงุก': '',
    'ููุช ุงูุจุฏุงูุฉ': '14:00',
    'ููุช ุงูููุงูุฉ': '16:00',
    'ููู ูุงูู': 'ูุง',
    'ุงููุตู': 'ุงุฌุชูุงุน ูุน ุฃูููุงุก ุงูุฃููุฑ',
    'ุงูููุน': 'ุงุฌุชูุงุน',
    'ุงูููู': '#4dabf7'
  },
  {
    'ุงูุนููุงู': 'ุงูุชุญุงูุงุช ุงููุตู ุงูุฃูู',
    'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2025-07-01',
    'ุชุงุฑูุฎ ุงูุงูุชูุงุก': '2025-07-05',
    'ููุช ุงูุจุฏุงูุฉ': '08:00',
    'ููุช ุงูููุงูุฉ': '12:00',
    'ููู ูุงูู': 'ูุง',
    'ุงููุตู': 'ุงูุชุญุงูุงุช ููุงูุฉ ุงููุตู ุงูุฃูู ุชูุชุฏ ูุฃุณุจูุน',
    'ุงูููุน': 'ุงูุชุญุงู',
    'ุงูููู': '#ffd43b'
  },
  {
    'ุงูุนููุงู': 'ุญูู ุงูุชุฎุฑุฌ',
    'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2025-07-15',
    'ุชุงุฑูุฎ ุงูุงูุชูุงุก': '',
    'ููุช ุงูุจุฏุงูุฉ': '10:00',
    'ููุช ุงูููุงูุฉ': '12:00',
    'ููู ูุงูู': 'ูุง',
    'ุงููุตู': 'ุญูู ุชูุฑูู ุงูุทูุงุจ ุงููุชุฎุฑุฌูู',
    'ุงูููุน': 'ุญุฏุซ',
    'ุงูููู': '#51cf66'
  },
  {
    'ุงูุนููุงู': 'ุนุทูุฉ ุงูุนูุฏ ุงููุทูู',
    'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2025-11-06',
    'ุชุงุฑูุฎ ุงูุงูุชูุงุก': '2025-11-07',
    'ููุช ุงูุจุฏุงูุฉ': '',
    'ููุช ุงูููุงูุฉ': '',
    'ููู ูุงูู': 'ูุนู',
    'ุงููุตู': 'ุนุทูุฉ ูุทููุฉ ูููููู',
    'ุงูููุน': 'ุนุทูุฉ',
    'ุงูููู': '#228be6'
  }
];

// ุฅูุดุงุก workbook ุฌุฏูุฏ
const wb = XLSX.utils.book_new();

// ุฅูุดุงุก worksheet ูู ุงูุจูุงูุงุช
const ws = XLSX.utils.json_to_sheet(eventsData);

// ุชุญุณูู ุนุฑุถ ุงูุฃุนูุฏุฉ
const range = XLSX.utils.decode_range(ws['!ref']);
const colWidths = [];
for (let C = range.s.c; C <= range.e.c; ++C) {
  let maxWidth = 10;
  for (let R = range.s.r; R <= range.e.r; ++R) {
    const cellAddress = XLSX.utils.encode_cell({ c: C, r: R });
    const cell = ws[cellAddress];
    if (cell && cell.v) {
      const cellValue = cell.v.toString();
      maxWidth = Math.max(maxWidth, cellValue.length + 2);
    }
  }
  colWidths.push({ wch: Math.min(maxWidth, 30) });
}
ws['!cols'] = colWidths;

// ุฅุถุงูุฉ ุงููุฑูุฉ ุฅูู ุงููุชุงุจ
XLSX.utils.book_append_sheet(wb, ws, 'ุงูุฃุญุฏุงุซ');

// ุฅูุดุงุก ูุฑูุฉ ุชุนูููุงุช
const instructionsData = [
  { 'ุงููุนูููุงุช': 'ุชุนูููุงุช ุงุณุชุฎุฏุงู ูููุฐุฌ ุงูุฃุญุฏุงุซ' },
  { 'ุงููุนูููุงุช': '' },
  { 'ุงููุนูููุงุช': '1. ุงูุนููุงู: ุงูุชุจ ุนููุงู ุงูุญุฏุซ' },
  { 'ุงููุนูููุงุช': '2. ุชุงุฑูุฎ ุงูุจุฏุงูุฉ: ุจุงูุตูุบุฉ YYYY-MM-DD (ูุซู: 2025-06-15)' },
  { 'ุงููุนูููุงุช': '3. ุชุงุฑูุฎ ุงูุงูุชูุงุก: ููุฃุญุฏุงุซ ูุชุนุฏุฏุฉ ุงูุฃูุงู ููุท (ุงุชุฑูู ูุงุฑุบุงู ููุฃุญุฏุงุซ ูููู ูุงุญุฏ)' },
  { 'ุงููุนูููุงุช': '4. ููุช ุงูุจุฏุงูุฉ: ุจุงูุตูุบุฉ HH:MM (ูุซู: 14:00) ุฃู ุงุชุฑูู ูุงุฑุบุงู ููุฃูุงู ุงููุงููุฉ' },
  { 'ุงููุนูููุงุช': '5. ููุช ุงูููุงูุฉ: ุจุงูุตูุบุฉ HH:MM (ูุซู: 16:00) ุฃู ุงุชุฑูู ูุงุฑุบุงู ููุฃูุงู ุงููุงููุฉ' },
  { 'ุงููุนูููุงุช': '6. ููู ูุงูู: ุงูุชุจ "ูุนู" ุฃู "ูุง"' },
  { 'ุงููุนูููุงุช': '7. ุงููุตู: ูุตู ูุฎุชุตุฑ ููุญุฏุซ' },
  { 'ุงููุนูููุงุช': '8. ุงูููุน: ุงุฎุชุฑ ูู (ุนุทูุฉุ ุงุฌุชูุงุนุ ุงูุชุญุงูุ ุญุฏุซ)' },
  { 'ุงููุนูููุงุช': '9. ุงูููู: ููุฏ ุงูููู ุจุตูุบุฉ hex (ูุซู: #ff6b6b)' },
  { 'ุงููุนูููุงุช': '' },
  { 'ุงููุนูููุงุช': 'ุฃูุซูุฉ ุนูู ุงูุฃุญุฏุงุซ ูุชุนุฏุฏุฉ ุงูุฃูุงู:' },
  { 'ุงููุนูููุงุช': '- ุนุทูุฉ ููุชุตู ุงูุณูุฉ: ูู 2025-01-20 ุฅูู 2025-01-26 (ุฃุณุจูุน ูุงูู)' },
  { 'ุงููุนูููุงุช': '- ุงูุชุญุงูุงุช ุงููุตู: ูู 2025-07-01 ุฅูู 2025-07-05 (ุฎูุณุฉ ุฃูุงู)' },
  { 'ุงููุนูููุงุช': '- ุนุทูุฉ ุงูุนูุฏ ุงููุทูู: ูู 2025-11-06 ุฅูู 2025-11-07 (ูููุงู)' },
  { 'ุงููุนูููุงุช': '' },
  { 'ุงููุนูููุงุช': 'ุฃููุงู ููุชุฑุญุฉ:' },
  { 'ุงููุนูููุงุช': 'ุงูุนุทู: #ff6b6b (ุฃุญูุฑ ูุงุชุญ)' },
  { 'ุงููุนูููุงุช': 'ุงูุงุฌุชูุงุนุงุช: #4dabf7 (ุฃุฒุฑู ูุงุชุญ)' },
  { 'ุงููุนูููุงุช': 'ุงูุงูุชุญุงูุงุช: #ffd43b (ุฃุตูุฑ ูุงุชุญ)' },
  { 'ุงููุนูููุงุช': 'ุงูุฃุญุฏุงุซ: #51cf66 (ุฃุฎุถุฑ ูุงุชุญ)' }
];

const instructionsWs = XLSX.utils.json_to_sheet(instructionsData);
instructionsWs['!cols'] = [{ wch: 50 }];
XLSX.utils.book_append_sheet(wb, instructionsWs, 'ุงูุชุนูููุงุช');

// ุญูุธ ุงูููู
const outputPath = path.join(__dirname, '..', 'public', 'ูููุฐุฌ_ุงูุฃุญุฏุงุซ.xlsx');
XLSX.writeFile(wb, outputPath);

console.log('โ ุชู ุฅูุดุงุก ููู ูููุฐุฌ ุงูุฃุญุฏุงุซ ุจูุฌุงุญ!');
console.log(`๐ ูุณุงุฑ ุงูููู: ${outputPath}`);