# دليل استخدام نظام الترحيل (Migrations Guide)

هذا الدليل يشرح كيفية استخدام نظام Sequelize CLI لإدارة تغييرات قاعدة البيانات بشكل آمن واحترافي.

## 1. ما هو نظام الترحيل؟
هو نظام يسمح لك بتتبع التغييرات في قاعدة البيانات (مثل إضافة جداول أو أعمدة) كملفات كود، مما يسمح لك بـ:
- مشاركة التغييرات مع الفريق.
- التراجع عن التغييرات بسهولة.
- معرفة حالة قاعدة البيانات في أي وقت.

## 2. الأوامر الأساسية

### التحقق من الحالة
لمعرفة ما هي الترحيلات التي تم تطبيقها والتي لم تطبق بعد:
```bash
npm run migrate:status
# أو
npx sequelize-cli db:migrate:status
```

### إنشاء ترحيل جديد (Migration)
عندما تريد تغيير شيء في قاعدة البيانات (مثلاً إضافة عمود "phone" لجدول الطلاب):
```bash
npm run migrate:create --name add-phone-to-students
```
سيتم إنشاء ملف جديد في `backend/database/migrations`. قم بفتحه وكتابة التغييرات المطلوبة في دالة `up` وكيفية التراجع عنها في دالة `down`.

### تطبيق التغييرات (Migrate)
لتنفيذ الترحيلات الجديدة على قاعدة البيانات:
```bash
npm run migrate
```

### التراجع عن آخر تغيير (Undo)
إذا أردت التراجع عن آخر عملية ترحيل قمت بها:
```bash
npm run migrate:undo
```

## 3. هيكل الملفات
- `backend/.sequelizerc`: ملف إعدادات يخبر CLI أين يجد الملفات.
- `backend/database/config/config.js`: إعدادات الاتصال بقاعدة البيانات.
- `backend/database/migrations/`: المجلد الذي يحتوي على جميع ملفات الترحيل.

## 4. ملاحظات هامة
- **لا تعدل** ملفات الترحيل القديمة التي تم تطبيقها بالفعل. إذا أردت تغيير شيء، أنشئ ترحيلاً جديداً.
- تأكد دائماً من كتابة كود التراجع (`down`) بشكل صحيح لتتمكن من العودة في حالة الخطأ.
